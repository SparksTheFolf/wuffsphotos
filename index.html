<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Furspective Photography</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Furspective Photography</h1>
    
    <div>
      <button onclick="loadGallery('ANE24')">ANE 2024</button>
      <button onclick="loadGallery('test')">Test</button>
    </div>

  </header>
  <br>
  <div id="gallery"></div>
    <script>

    // Existing functions: loadGallery, loadRandomGallery, shuffleArray

    // Load the JSON file containing fursona information
    async function loadFursonaInfo(folderName) {
      try {
        const response = await fetch(`/${folderName}/fursonaInfo.json`);
        const data = await response.json();
        return data;
      } catch (error) {
        console.error('Error fetching fursona info:', error);
        return {};
      }
    }

    // Open a popup with fursona information when a photo is clicked
    function openPopup(imageUrl, fursonaInfo) {
      const isCtrlKey = event.ctrlKey || event.metaKey; // Check if Ctrl or Command key is pressed
      if (!isCtrlKey) {
        const popup = document.createElement('div');
        popup.classList.add('popup');
      
        const img = document.createElement('img');
        img.src = imageUrl;
        img.alt = 'Popup Image';
        img.classList.add('popup-image');
      
        const infoDiv = document.createElement('div');
        infoDiv.classList.add('popup-info');

        const fursonaName = fursonaInfo.Fursona || 'Unknown';
        const twitterHandle = fursonaInfo.TwitterHandle || 'N/A';
        const dateOfPicture = fursonaInfo.DateOfPicture || 'Unknown';

        infoDiv.innerHTML = `
          <p>Fursona Name: ${fursonaName}</p>
          <p>Twitter Handle: ${twitterHandle}</p>
          <p>Date of Picture: ${dateOfPicture}</p>
        `;
      
        popup.appendChild(img);
        popup.appendChild(infoDiv);
        document.body.appendChild(popup);
      
        // Add an event listener to close the popup when clicked outside
        popup.addEventListener('click', () => closePopup(popup));
      } else {
        // If Ctrl or Command key is pressed, let the browser handle opening in a new tab
        window.open(imageUrl, '_blank');
      }
    }

    // Close the popup
    function closePopup(popup) {
      popup.remove();
    }

    // Load fursona information and set up photo click event listeners
    async function setupGallery(folderName) {
      const fursonaInfo = await loadFursonaInfo(folderName);

      // Add click event listeners to each image in the gallery
      const images = document.querySelectorAll('.image-container img');
      images.forEach((img, index) => {
        img.addEventListener('click', () => openPopup(img.src, fursonaInfo[index + 1]));
      });
    }

    // Modify your existing window.addEventListener to call setupGallery
    window.addEventListener('DOMContentLoaded', async () => {
      await loadRandomGallery(); // Load random gallery
      await setupGallery('ANE24'); // Setup gallery with fursona info
    });

    </script>

  <br>

  <footer>
    <p>Â© 2024 Furspective Photography (A division of Sparks The Folf products)</p>
    <p><a href="https://photos.wuffs.net/Furspective-Photography-CopyrightNotice.txt">Images Copyright Notice</a></p>
  </footer>
</body>
</html>
